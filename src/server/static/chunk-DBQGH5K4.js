import{a as f}from"./chunk-ZQFK667Q.js";import{a as q}from"./chunk-BAP55IBU.js";import{a,b as y,c as C,d as R,e as E}from"./chunk-4IFBPCWC.js";import{a as u}from"./chunk-LZOUE64L.js";import{A as m,Bb as i,D as S,M as b,O as s,R as v,Tb as h,X as n,i as r,w as p,y as d}from"./chunk-6VFV3J45.js";var c=class t{http=n(h);loadCalls(){return this.http.post(`${u.REST}/button/call/list`,{})}loadCommunications(){return this.http.post(`${u.REST}/button/comm`,{})}abortCall(e){return this.http.post(`${u.REST}/button/call/abort/${e}`,{})}static \u0275fac=function(l){return new(l||t)};static \u0275prov=v({token:t,factory:t.\u0275fac})};var O={callsState:{data:null,state:"idle"},communicationsState:{data:null,state:"idle"},removeState:{data:null,state:"idle"},pesquisando:!1},H=y(E(O),R((t,e=n(c),l=n(q))=>({loadCalls(){a(t,{callsState:{data:null,state:"loading"},pesquisando:!1}),p(0,5e3).pipe(f(),d(()=>!t.pesquisando()),s(()=>a(t,{pesquisando:!0})),b(()=>e.loadCalls().pipe(S(1),s(o=>{a(t,{callsState:{data:o,state:"success"}})}),m(o=>(a(t,{callsState:{data:null,state:"error"}}),l.error(o.message),r)))),s(()=>a(t,{pesquisando:!1}))).subscribe()},loadCommunications(){a(t,{communicationsState:{data:null,state:"loading"},pesquisando:!1}),p(0,2e3).pipe(f(),d(()=>!t.pesquisando()),s(()=>a(t,{pesquisando:!0})),b(()=>e.loadCommunications().pipe(s(o=>{a(t,{communicationsState:{data:o,state:"success"}})}),m(o=>(a(t,{communicationsState:{data:null,state:"error"}}),l.error(o.message),r)))),s(()=>a(t,{pesquisando:!1}))).subscribe()},abortCall(o){a(t,{}),e.abortCall(o).pipe(S(1),s(()=>{a(t,{removeState:{data:null,state:"success"}}),l.success("Removido com sucesso.")}),m(j=>(a(t,{removeState:{data:null,state:"error"}}),l.error(j.message),r))).subscribe()}})),C(t=>({callsColumns:i(()=>t.callsState()?.data?Object.keys(t.callsState().data[0]):[]),callsRows:i(()=>t.callsState()?.data?t.callsState().data?.map(e=>Object.values(e)):[]),communicationsColumns:i(()=>t.communicationsState()?.data?Object.keys(t.communicationsState().data[0]):[]),communicationsRows:i(()=>t.communicationsState()?.data?t.communicationsState().data?.map(e=>Object.values(e)):[])})));export{c as a,H as b};
